FDISK(8)                    System Manager's Manual                   FDISK(8)

NNAAMMEE
     ffddiisskk - partition table maintenance program

SSYYNNOOPPSSIISS
     ffddiisskk [--eevvyy] [--AA | --gg | --ii | --uu] [--bb _b_l_o_c_k_s[@_o_f_f_s_e_t[:_t_y_p_e]]]
           [--ll _b_l_o_c_k_s | --cc _c_y_l_i_n_d_e_r_s --hh _h_e_a_d_s --ss _s_e_c_t_o_r_s] [--ff _f_i_l_e] _d_i_s_k

DDEESSCCRRIIPPTTIIOONN
     ffddiisskk creates and edits MBR and GPT partition tables.  These tables are
     used by the boot process of some platforms to find the OpenBSD kernel
     and, when present, are used by the kernel to find the disklabel(5).

     Caution is advised when editing these tables since some platforms rely on
     specific configurations created at install time.

     The options are as follows:

     --AA      Modifies the GPT partition table entries on _d_i_s_k to put all
             available space not taken by --bb into a single OpenBSD partition.
             The available space is maximized by deleting all existing
             partition entries except for partition types APFS ISC, APFS, APFS
             Recovery, BIOS Boot, HiFive FSBL, HiFive BBL and partitions with
             the `Required' GPT attribute set.

             If APFS ISC, APFS, or APFS Recovery partitions are detected then
             existing EFI system partitions are also preserved.  If the
             preserved EFI system partition has fewer blocks than the number
             requested with --bb, the modified GPT is discarded.

     --bb _b_l_o_c_k_s[@_o_f_f_s_e_t[:_t_y_p_e]]
             Creates a partition table entry of the specified number of
             blocks, offset and type.  _o_f_f_s_e_t defaults to the first available
             block, and _t_y_p_e defaults to `EF'.

             --bb is only available in combination with --AA, --gg, or --ii.

             If --AA or --gg is specified, only the _b_l_o_c_k_s value is used.

     --cc _c_y_l_i_n_d_e_r_s --hh _h_e_a_d_s --ss _s_e_c_t_o_r_s
             Specifies a geometry for ffddiisskk to use.  By default the disk size
             and geometry are obtained from the default disklabel(5)
             constructed by the kernel for _d_i_s_k.  See disklabel(5) and
             disklabel(8).

     --ee      Invokes the interactive partition table editor.  See _C_O_M_M_A_N_D _M_O_D_E
             below.

     --ff _f_i_l_e
             Specifies a file containing the bootcode for an MBR.  The default
             file is _/_u_s_r_/_m_d_e_c_/_m_b_r.

     --gg      Writes a default GPT, including a protective MBR, to _d_i_s_k.  The
             GPT has a single OpenBSD partition containing all available space
             not taken by --bb.

     --ii      Writes a default MBR to _d_i_s_k.  The MBR has a single OpenBSD
             partition containing all the available space not taken by --bb.
             The bootcode is initialized as described in --uu.

     --ll _c_o_u_n_t
             Treat _d_i_s_k as though it has a size of _c_o_u_n_t blocks.

     --uu      Updates the MBR bootcode.  If a bootcode file is present (see --ff)
             the MBR, except for the partition entries, is replaced by the
             first block of the file.  If no bootcode file is present, zeros
             are used.

             Not available when editing a GPT.

     --vv      Prints detailed information about the MBR, the Primary GPT and
             the Secondary GPT.

     --yy      New or modified partition table is written to disk without asking
             for confirmation.

     _d_i_s_k    ffddiisskk creates or modifies the partition table of _d_i_s_k.  _d_i_s_k can
             be a full pathname, e.g.  _/_d_e_v_/_r_s_d_0_c, a raw partition name, e.g.
             _s_d_0_c, or just the disk name, e.g.  _s_d_0.

TTYYPPIICCAALL LLAAYYOOUUTT
     When called without options ffddiisskk prints the partition table of _d_i_s_k.

     If _d_i_s_k has a GPT a terse version of its contents is printed:

      # fdisk sd0
      Disk: sd0       Usable LBA: 64 to 500118128 [500118192 Sectors]
         #: type                                 [       start:         size ]
      ------------------------------------------------------------------------
         1: EFI Sys                              [          64:          960 ]
         3: OpenBSD                              [        1024:    500117105 ]

     When _d_i_s_k does not have a GPT, the first block of _d_i_s_k is printed as an
     MBR:

      # fdisk sd0
      Disk: sd0      geometry: 121601/255/63 [1953525168 Sectors]
      Offset: 0      Signature: 0xAA55
                 Starting       Ending      LBA Info:
       #: id     C  H  S -      C   H  S [     start:       size ]
      ------------------------------------------------------------------------
       0: 0B     0  1  1 -  26108   0 63 [        63:  419425020 ] FAT32
       1: 00     0  0  0 -      0   0  0 [         0:          0 ] unused
       2: 00     0  0  0 -      0   0  0 [         0:          0 ] unused
      *3: A6 26108  1  1 - 121600 254 63 [ 419425083: 1534094982 ] OpenBSD

     _N_O_T_E: Partition entry #3 of this MBR is flagged as bootable.

     _N_O_T_E: The _S field in the C/H/S values is "1 based", but the LBA "start"
     field is "0 based".

     The --vv option causes more information to be printed:

      # fdisk -v sd0
      Primary GPT:
      Disk: sd0       Usable LBA: 64 to 500118128 [500118192 Sectors]
      GUID: f0418899-4976-4604-a783-3ebe135a8f12
         #: type                                 [       start:         size ]
            guid                                 name
      ------------------------------------------------------------------------
         1: EFI Sys                              [          64:          960 ]
            d0834013-dab8-44df-a5e4-123148f17e03 EFI System Area
         3: OpenBSD                              [        1024:    500117105 ]
            cd356d77-8369-44b4-996e-79e8b9a47bfe OpenBSD Area

      Secondary GPT:
      Disk: sd0       Usable LBA: 64 to 500118128 [500118192 Sectors]
      GUID: f0418899-4976-4604-a783-3ebe135a8f12
         #: type                                 [       start:         size ]
            guid                                 name
      ------------------------------------------------------------------------
         1: EFI Sys                              [          64:          960 ]
            d0834013-dab8-44df-a5e4-123148f17e03 EFI System Area
         3: OpenBSD                              [        1024:    500117105 ]
            cd356d77-8369-44b4-996e-79e8b9a47bfe OpenBSD Area

      MBR:
      Disk: sd0       geometry: 31130/255/63 [500118192 Sectors]
      Offset: 0       Signature: 0xAA55
                  Starting         Ending         LBA Info:
       #: id      C   H   S -      C   H   S [       start:        size ]
      -------------------------------------------------------------------------------
       0: EE      0   0   2 -  31130 233  63 [           1:   500118191 ] EFI GPT
       1: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
       2: 00      0   0   0 -      0   0   0 [           0:           0 ] unused
       3: 00      0   0   0 -      0   0   0 [           0:           0 ] unused

CCOOMMMMAANNDD MMOODDEE
     When ffddiisskk enters interactive command mode it copies the partition table
     from _d_i_s_k into memory and performs all edits on that copy.  The partition
     table on _d_i_s_k is modified only by _w_r_i_t_e or _q_u_i_t commands.

     The prompt contains information about the state of the edit process.

           _d_i_s_k*:1>

     Where _d_i_s_k is the name of the disk being edited, `*' means that the
     partition table has been modified, but not yet written to disk and 1 is
     the edit level when operating on the MBR or GPT.  This number is 2 when
     editing an extended partition in the MBR, 3 when editing an extended
     partition within the edit level 2 extended partition, and so on.

     The list of commands and their functions is given below.  Commands may be
     abbreviated.  The first command matching the abbreviation is selected.

     ??       A synonym for hheellpp.

     hheellpp    Displays a short summary of available commands.

     mmaannuuaall  Displays this manual page.

     rreeiinniitt [ggpptt | mmbbrr]
             Initializes the partition table.

             By default an MBR partition table is initialized.  If ggpptt is
             specified a GPT partition table is initialized, including the
             protective MBR.

     sseettppiidd _#
             Sets the identifier of the partition table entry.

     eeddiitt _#  Edit an entry in the partition table.  The offset and size of the
             entry may be specified in CHS mode (MBR only), by using sector
             offsets and sizes, or by using the units `b', `k', `m', `g', or
             `t' to indicate bytes, kilobytes, megabytes, gigabytes, or
             terabytes.  The special size value `*' causes the partition to be
             sized to use the remainder of the disk.

     ffllaagg _# [_v_a_l_u_e]
             Set the partition's flag (MBR) or attribute (GPT) value.  _v_a_l_u_e
             can be a positive integer or a hex string.  An MBR partition will
             accept values from 0 to 0xff.  A GPT partition will accept values
             from 0 to 0xfffffffffffffff.  If _v_a_l_u_e is not provided the
             partition's bootable flag is set and all other partitions have
             their bootable flags reset.  MBR partitions with the bootable
             flag set are printed with a `*' prefix.  GPT partitions with the
             bootable flag set display 'bootable' in their attributes list.

     uuppddaattee  Updates the MBR bootcode.  If a bootcode file is present (see --ff)
             the MBR, except for the partition entries, is replaced by the
             first block of the file.  If no bootcode file is present, zeros
             are used.

             Not available when editing a GPT.

     sseelleecctt _#
             Selects an extended partition entry, increasing the edit level by
             1.

             Not available when editing a GPT.

     sswwaapp _# _#
             Swaps two partition entries.

     pprriinntt [_u_n_i_t]
             Prints the partition table.  If _u_n_i_t is `b', `k', `m', `g', or
             `t' partition sizes are shown in bytes, kilobytes, megabytes,
             gigabytes, or terabytes.  If _u_n_i_t is not provided, sizes are
             shown in sectors.

     wwrriittee   Writes the partition table to disk.

     eexxiitt    Discards outstanding changes and exits the current edit level.
             If the edit level is 1, ffddiisskk terminates.

     qquuiitt    Writes outstanding changes to disk and exits the current edit
             level.  If the edit level is 1, ffddiisskk terminates.

     aabboorrtt   Discards outstanding changes and terminates ffddiisskk.

FFIILLEESS
     _/_u_s_r_/_m_d_e_c_/_m_b_r  default MBR bootcode

SSEEEE AALLSSOO
     disklabel(5), boot(8), boot_amd64(8), boot_i386(8), boot_macppc(8),
     disklabel(8)

OpenBSD 7.4                    November 10, 2023                   OpenBSD 7.4
